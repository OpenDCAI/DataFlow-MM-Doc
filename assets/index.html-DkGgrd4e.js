import{_ as e,c as l,b as n,a as i,d as t,e as h,w as k,r as d,o as p}from"./app-Ct5swOin.js";const r={};function g(o,s){const a=d("VPLink");return p(),l("div",null,[s[4]||(s[4]=n(`<h2 id="ğŸ“˜-æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#ğŸ“˜-æ¦‚è¿°"><span>ğŸ“˜ æ¦‚è¿°</span></a></h2><p><code>VideoAestheticFilter</code> æ˜¯ä¸€ä¸ªåŸºäº<strong>ç¾å­¦åˆ†æ•°</strong>çš„è§†é¢‘è¿‡æ»¤ç®—å­ã€‚å®ƒç›´æ¥å¯¹æ•´ä¸ªè§†é¢‘è¿›è¡Œç¾å­¦è¯„åˆ†å’Œè¿‡æ»¤ï¼Œæ— éœ€é¢„å…ˆåˆ‡åˆ†ç‰‡æ®µï¼š</p><ol><li>ä»è§†é¢‘ä¸­é‡‡æ ·è‹¥å¹²å¸§</li><li>ä½¿ç”¨ CLIP æ¨¡å‹å’Œ MLP æ¨¡å‹è®¡ç®—ç¾å­¦åˆ†æ•°</li><li>æ ¹æ®æœ€å°ç¾å­¦åˆ†æ•°é˜ˆå€¼ï¼ˆ<code>aes_min</code>ï¼‰åˆ¤æ–­æ˜¯å¦é€šè¿‡è¿‡æ»¤</li><li>è¾“å‡ºåŒ…å« <code>aesthetic_score</code> å’Œ <code>filtered</code> å­—æ®µçš„ç»“æœ</li></ol><p>é€‚ç”¨äºåˆæ­¥ç­›é€‰è§†é¢‘è´¨é‡ï¼Œå¿«é€Ÿè¿‡æ»¤ä½è´¨é‡è§†é¢‘ã€‚</p><hr><h2 id="ğŸ—ï¸-init-å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#ğŸ—ï¸-init-å‡½æ•°"><span>ğŸ—ï¸ <code>__init__</code> å‡½æ•°</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">def</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> __init__</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    input_video_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">video</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    clip_model</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ViT-L/14</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    mlp_checkpoint</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Optional</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> None</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    load_num</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> int</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    batch_size</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> int</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 64</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    num_workers</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> int</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    output_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">video_aesthetic</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    aes_min</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Optional</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">float</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> None</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">):</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ğŸ§¾-init-å‚æ•°è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ğŸ§¾-init-å‚æ•°è¯´æ˜"><span>ğŸ§¾ <code>__init__</code> å‚æ•°è¯´æ˜</span></a></h2><table><thead><tr><th style="text-align:left;">å‚æ•°å</th><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">é»˜è®¤å€¼</th><th style="text-align:left;">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left;"><code>input_video_key</code></td><td style="text-align:left;"><code>str</code></td><td style="text-align:left;"><code>&quot;video&quot;</code></td><td style="text-align:left;">è¾“å…¥æ•°æ®ä¸­è§†é¢‘è·¯å¾„å­—æ®µå</td></tr><tr><td style="text-align:left;"><code>clip_model</code></td><td style="text-align:left;"><code>str</code></td><td style="text-align:left;"><code>&quot;ViT-L/14&quot;</code></td><td style="text-align:left;">CLIP æ¨¡å‹åç§°æˆ–è·¯å¾„</td></tr><tr><td style="text-align:left;"><code>mlp_checkpoint</code></td><td style="text-align:left;"><code>Optional[str]</code></td><td style="text-align:left;"><code>None</code></td><td style="text-align:left;">MLP æ£€æŸ¥ç‚¹è·¯å¾„ï¼Œç”¨äºç¾å­¦é¢„æµ‹</td></tr><tr><td style="text-align:left;"><code>load_num</code></td><td style="text-align:left;"><code>int</code></td><td style="text-align:left;"><code>3</code></td><td style="text-align:left;">ä»è§†é¢‘ä¸­é‡‡æ ·çš„å¸§æ•°</td></tr><tr><td style="text-align:left;"><code>batch_size</code></td><td style="text-align:left;"><code>int</code></td><td style="text-align:left;"><code>64</code></td><td style="text-align:left;">å¤„ç†æ‰¹æ¬¡å¤§å°</td></tr><tr><td style="text-align:left;"><code>num_workers</code></td><td style="text-align:left;"><code>int</code></td><td style="text-align:left;"><code>4</code></td><td style="text-align:left;">æ•°æ®åŠ è½½çš„ worker è¿›ç¨‹æ•°</td></tr><tr><td style="text-align:left;"><code>output_key</code></td><td style="text-align:left;"><code>str</code></td><td style="text-align:left;"><code>&quot;video_aesthetic&quot;</code></td><td style="text-align:left;">è¾“å‡ºå­—æ®µå</td></tr><tr><td style="text-align:left;"><code>aes_min</code></td><td style="text-align:left;"><code>Optional[float]</code></td><td style="text-align:left;"><code>None</code></td><td style="text-align:left;">æœ€å°ç¾å­¦åˆ†æ•°é˜ˆå€¼ï¼Œä½äºæ­¤å€¼çš„è§†é¢‘å°†è¢«æ ‡è®°ä¸º <code>filtered=False</code></td></tr></tbody></table><hr><h2 id="âš¡-run-å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#âš¡-run-å‡½æ•°"><span>âš¡ <code>run</code> å‡½æ•°</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">def</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> DataFlowStorage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    input_video_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Optional</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> None</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    clip_model</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Optional</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> None</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    mlp_checkpoint</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Optional</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> None</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    load_num</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Optional</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">int</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> None</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    batch_size</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Optional</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">int</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> None</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    num_workers</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Optional</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">int</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> None</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    output_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Optional</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> None</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    aes_min</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Optional</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">float</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> None</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> -&gt;</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> None</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œç®—å­ä¸»é€»è¾‘ï¼šä» storage è¯»å–æ•°æ®è¡¨ï¼Œå¯¹æ¯ä¸ªè§†é¢‘é‡‡æ ·å¸§å¹¶è®¡ç®—ç¾å­¦åˆ†æ•°ï¼Œæ ¹æ®é˜ˆå€¼è¿‡æ»¤ï¼Œå¹¶å†™å›å­˜å‚¨ã€‚</p><h2 id="ğŸ§¾-run-å‚æ•°è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ğŸ§¾-run-å‚æ•°è¯´æ˜"><span>ğŸ§¾ <code>run</code> å‚æ•°è¯´æ˜</span></a></h2><table><thead><tr><th style="text-align:left;">å‚æ•°å</th><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">é»˜è®¤å€¼</th><th style="text-align:left;">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left;"><code>storage</code></td><td style="text-align:left;"><code>DataFlowStorage</code></td><td style="text-align:left;">-</td><td style="text-align:left;">Dataflow æ•°æ®å­˜å‚¨å¯¹è±¡</td></tr><tr><td style="text-align:left;"><code>input_video_key</code></td><td style="text-align:left;"><code>Optional[str]</code></td><td style="text-align:left;"><code>None</code></td><td style="text-align:left;">è§†é¢‘è·¯å¾„å­—æ®µåï¼ˆè¦†ç›–åˆå§‹åŒ–å‚æ•°ï¼‰</td></tr><tr><td style="text-align:left;"><code>clip_model</code></td><td style="text-align:left;"><code>Optional[str]</code></td><td style="text-align:left;"><code>None</code></td><td style="text-align:left;">CLIP æ¨¡å‹è·¯å¾„ï¼ˆè¦†ç›–åˆå§‹åŒ–å‚æ•°ï¼‰</td></tr><tr><td style="text-align:left;"><code>mlp_checkpoint</code></td><td style="text-align:left;"><code>Optional[str]</code></td><td style="text-align:left;"><code>None</code></td><td style="text-align:left;">MLP æ£€æŸ¥ç‚¹è·¯å¾„ï¼ˆè¦†ç›–åˆå§‹åŒ–å‚æ•°ï¼‰</td></tr><tr><td style="text-align:left;"><code>load_num</code></td><td style="text-align:left;"><code>Optional[int]</code></td><td style="text-align:left;"><code>None</code></td><td style="text-align:left;">é‡‡æ ·å¸§æ•°ï¼ˆè¦†ç›–åˆå§‹åŒ–å‚æ•°ï¼‰</td></tr><tr><td style="text-align:left;"><code>batch_size</code></td><td style="text-align:left;"><code>Optional[int]</code></td><td style="text-align:left;"><code>None</code></td><td style="text-align:left;">æ‰¹æ¬¡å¤§å°ï¼ˆè¦†ç›–åˆå§‹åŒ–å‚æ•°ï¼‰</td></tr><tr><td style="text-align:left;"><code>num_workers</code></td><td style="text-align:left;"><code>Optional[int]</code></td><td style="text-align:left;"><code>None</code></td><td style="text-align:left;">worker æ•°é‡ï¼ˆè¦†ç›–åˆå§‹åŒ–å‚æ•°ï¼‰</td></tr><tr><td style="text-align:left;"><code>output_key</code></td><td style="text-align:left;"><code>Optional[str]</code></td><td style="text-align:left;"><code>None</code></td><td style="text-align:left;">è¾“å‡ºå­—æ®µåï¼ˆè¦†ç›–åˆå§‹åŒ–å‚æ•°ï¼‰</td></tr><tr><td style="text-align:left;"><code>aes_min</code></td><td style="text-align:left;"><code>Optional[float]</code></td><td style="text-align:left;"><code>None</code></td><td style="text-align:left;">æœ€å°ç¾å­¦åˆ†æ•°é˜ˆå€¼ï¼ˆè¦†ç›–åˆå§‹åŒ–å‚æ•°ï¼‰</td></tr></tbody></table><hr><h2 id="ğŸ§ -ç¤ºä¾‹ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#ğŸ§ -ç¤ºä¾‹ç”¨æ³•"><span>ğŸ§  ç¤ºä¾‹ç”¨æ³•</span></a></h2><div class="hint-container tip"><p class="hint-container-title">å®Œæ•´ç¤ºä¾‹ä»£ç </p><p>å®Œæ•´çš„æµæ°´çº¿ç¤ºä¾‹ä»£ç ä½äºï¼š<code>playground/video_aesthetic_filter_pipeline.py</code></p><p>åœ¨ä½¿ç”¨ <code>dataflowmm init</code> åˆå§‹åŒ–åï¼Œä½ å¯ä»¥åœ¨è¯¥è·¯å¾„ä¸‹æ‰¾åˆ°å®Œæ•´çš„å¯è¿è¡Œç¤ºä¾‹ã€‚</p></div><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> dataflow</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">utils</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> FileStorage</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> dataflow</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">operators</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">core_vision </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> VideoAestheticFilter</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Step 1: å‡†å¤‡ FileStorageï¼ˆè‡³å°‘åŒ…å« video åˆ—ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> FileStorage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    first_entry_file_name</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">data/video_aesthetic_input.jsonl</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    cache_path</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">./cache_local</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    file_name_prefix</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">video_aesthetic_filter</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    cache_type</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">jsonl</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Step 2: åˆå§‹åŒ–ç®—å­</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">filter_op </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> VideoAestheticFilter</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    output_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">video_aesthetic</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    load_num</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # ä»è§†é¢‘ä¸­é‡‡æ · 3 å¸§</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    batch_size</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">16</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    num_workers</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    clip_model</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ViT-L/14</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    mlp_checkpoint</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/path/to/sac+logos+ava1-l14-linearMSE.pth</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    aes_min</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">4.0</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # æœ€å°ç¾å­¦åˆ†æ•°é˜ˆå€¼</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Step 3: æ‰§è¡Œè¿‡æ»¤</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">filter_op</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">step</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(),</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    input_video_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">video</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    output_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">video_aesthetic</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="ğŸ§¾-è¾“å‡ºæ ¼å¼" tabindex="-1"><a class="header-anchor" href="#ğŸ§¾-è¾“å‡ºæ ¼å¼"><span>ğŸ§¾ è¾“å‡ºæ ¼å¼</span></a></h2><p><strong>æ–°å¢å­—æ®µï¼š</strong></p><ul><li><code>video_aesthetic</code> (dict): ç¾å­¦è¯„åˆ†ä¿¡æ¯å­—å…¸</li></ul><p><strong>å­—å…¸å­—æ®µï¼š</strong></p><table><thead><tr><th style="text-align:left;">å­—æ®µ</th><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left;"><code>aesthetic_score</code></td><td style="text-align:left;"><code>float</code></td><td style="text-align:left;">è§†é¢‘ç¾å­¦åˆ†æ•°</td></tr><tr><td style="text-align:left;"><code>filtered</code></td><td style="text-align:left;"><code>bool</code></td><td style="text-align:left;">æ˜¯å¦é€šè¿‡è¿‡æ»¤ï¼ˆä»…å½“è®¾ç½®äº† <code>aes_min</code> æ—¶å‡ºç°ï¼‰</td></tr></tbody></table><p>ç¤ºä¾‹è¾“å…¥ï¼š</p><div class="language-jsonl line-numbers-mode" data-highlighter="shiki" data-ext="jsonl" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-jsonl"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">video</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">./test/video1.mp4</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">video</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">./test/video2.mp4</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¤ºä¾‹è¾“å‡ºï¼ˆè®¾ç½®äº† <code>aes_min=4.0</code>ï¼‰ï¼š</p><div class="language-jsonl line-numbers-mode" data-highlighter="shiki" data-ext="jsonl" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-jsonl"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">video</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">./test/video1.mp4</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;"> &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">video_aesthetic</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">aesthetic_score</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5.2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;"> &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">filtered</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}}</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">video</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">./test/video2.mp4</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;"> &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">video_aesthetic</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">aesthetic_score</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3.5</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;"> &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">filtered</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">}}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="ğŸ”—-ç›¸å…³é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#ğŸ”—-ç›¸å…³é“¾æ¥"><span>ğŸ”— ç›¸å…³é“¾æ¥</span></a></h2>`,31)),i("ul",null,[s[3]||(s[3]=i("li",null,[i("strong",null,"ä»£ç :"),t(),i("a",{href:"https://github.com/OpenDCAI/DataFlow-MM/blob/main/dataflow/operators/core_vision/filter/video_aesthetic_filter.py",target:"_blank",rel:"noopener noreferrer"},"VideoAestheticFilter")],-1)),i("li",null,[s[1]||(s[1]=i("strong",null,"ç›¸å…³ç®—å­:",-1)),s[2]||(s[2]=t()),h(a,{href:"/zh/mm_operators/video_understanding/eval/video_aesthetic_evaluator/"},{default:k(()=>s[0]||(s[0]=[t("VideoAestheticEvaluator")])),_:1,__:[0]})])])])}const c=e(r,[["render",g]]),A=JSON.parse('{"path":"/zh/mm_operators/video_understanding/filter/video_aesthetic_filter/","title":"è§†é¢‘ç¾å­¦è¿‡æ»¤ï¼ˆVideoAestheticFilterï¼‰","lang":"zh-CN","frontmatter":{"title":"è§†é¢‘ç¾å­¦è¿‡æ»¤ï¼ˆVideoAestheticFilterï¼‰","createTime":"2025/01/20 10:00:00","permalink":"/zh/mm_operators/video_understanding/filter/video_aesthetic_filter/"},"readingTime":{"minutes":2.58,"words":775},"git":{"createdTime":1770060543000,"updatedTime":1770060543000,"contributors":[{"name":"éƒ‘å…ƒé¸¿","username":"","email":"zhengyuanhong@zhengyuanhongdeMac-mini.local","commits":1,"avatar":"https://gravatar.com/avatar/f6e3e67cd4a27906523a73a2b961b53a6d2c79d8f94a3fa3174d8ee7fa3dbd0b?d=retro"}]},"filePathRelative":"zh/notes/mm_operators/video_understanding/filter/video_aesthetic_filter.md","headers":[]}');export{c as comp,A as data};
