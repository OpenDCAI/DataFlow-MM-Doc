import{_ as i,c as a,b as n,o as t}from"./app-Ct5swOin.js";const h={};function l(e,s){return t(),a("div",null,s[0]||(s[0]=[n(`<h2 id="ğŸ“˜-æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#ğŸ“˜-æ¦‚è¿°"><span>ğŸ“˜ æ¦‚è¿°</span></a></h2><p><code>ImageBboxGenerator</code> æ˜¯ä¸€ä¸ª <strong>å›¾åƒåŒºåŸŸæ ‡æ³¨ä¸æç¤ºè¯å‡†å¤‡ç®—å­</strong>ã€‚</p><p>è¯¥ç®—å­ä¸»è¦ç”¨äºå¤šæ¨¡æ€ä»»åŠ¡ï¼ˆå¦‚ Grounding Captionï¼‰çš„æ•°æ®é¢„å¤„ç†ã€‚å®ƒèƒ½å¤Ÿå¤„ç†åŒ…å«å›¾åƒè·¯å¾„çš„åŸå§‹æ•°æ®ï¼Œå¯¹æ„Ÿå…´è¶£åŒºåŸŸï¼ˆRegion of Interestï¼‰è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†å’Œå¯è§†åŒ–ç»˜åˆ¶ï¼Œå¹¶ç”Ÿæˆç”¨äºåç»­ VLM æ¨ç†çš„ Promptã€‚</p><p>æ ¸å¿ƒèƒ½åŠ›ï¼š</p><ol><li><strong>åŒæ¨¡å¼ BBox è·å–</strong>ï¼š</li></ol><ul><li><strong>å·²æœ‰æ¡†æ¨¡å¼</strong>ï¼šç›´æ¥è¯»å–è¾“å…¥æ•°æ®ä¸­å·²æœ‰çš„ BBox åæ ‡ã€‚</li><li><strong>è‡ªåŠ¨æå–æ¨¡å¼</strong>ï¼šè‹¥æ—  BBoxï¼Œåˆ©ç”¨ OpenCVï¼ˆè¾¹ç¼˜æ£€æµ‹ + è½®å»“æ‹Ÿåˆï¼‰è‡ªåŠ¨æå–å›¾åƒä¸­çš„æ˜¾è‘—ç‰©ä½“åŒºåŸŸã€‚</li></ul><ol start="2"><li><strong>åæ ‡æ ‡å‡†åŒ–</strong>ï¼šå°†åƒç´ åæ ‡è½¬æ¢ä¸ºç¬¦åˆ VLM è¾“å…¥è§„èŒƒçš„å½’ä¸€åŒ–åæ ‡ï¼ˆ0-1 æˆ– 0-1000ï¼‰ã€‚</li><li><strong>å¯è§†åŒ–å¢å¼º</strong>ï¼šç”Ÿæˆå¸¦æœ‰æ•°å­—ç¼–å·å’Œå½©è‰²è¾¹æ¡†çš„å¯è§†åŒ–å›¾åƒï¼Œè¾…åŠ©æ¨¡å‹ç†è§£â€œç¬¬ N ä¸ªåŒºåŸŸâ€çš„æŒ‡ä»£å…³ç³»ã€‚</li><li><strong>Prompt æ„é€ </strong>ï¼šè‡ªåŠ¨ç”ŸæˆåŒ…å«åŒºåŸŸæ•°é‡ä¿¡æ¯çš„ Promptï¼ˆå¦‚ &quot;Describe the content of each marked region...&quot;ï¼‰ã€‚</li></ol><h2 id="ğŸ—ï¸-init-å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#ğŸ—ï¸-init-å‡½æ•°"><span>ğŸ—ï¸ <code>__init__</code> å‡½æ•°</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">def</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> __init__</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> config</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Optional</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">ExistingBBoxDataGenConfig</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> None</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">):</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ğŸ§¾-å‚æ•°è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ğŸ§¾-å‚æ•°è¯´æ˜"><span>ğŸ§¾ å‚æ•°è¯´æ˜</span></a></h3><table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>config</code></td><td><code>ExistingBBoxDataGenConfig</code></td><td><code>None</code></td><td>é…ç½®å¯¹è±¡ï¼Œå®šä¹‰äº†è¾“å…¥è¾“å‡ºè·¯å¾„åŠæœ€å¤§æ¡†æ•°é‡é™åˆ¶ã€‚</td></tr></tbody></table><h4 id="existingbboxdatagenconfig-é…ç½®è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#existingbboxdatagenconfig-é…ç½®è¯¦è§£"><span><code>ExistingBBoxDataGenConfig</code> é…ç½®è¯¦è§£</span></a></h4><table><thead><tr><th>å­—æ®µå</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>max_boxes</code></td><td><code>int</code></td><td><code>10</code></td><td>å•å¼ å›¾åƒä¿ç•™çš„æœ€å¤§ BBox æ•°é‡ï¼ˆæŒ‰é¢ç§¯æ’åºï¼‰ã€‚ä¸è¶³éƒ¨åˆ†è¡¥é›¶ã€‚</td></tr><tr><td><code>input_jsonl_path</code></td><td><code>str</code></td><td><code>None</code></td><td><strong>å¿…é¡»æŒ‡å®š</strong>ã€‚è¾“å…¥ JSONL æ–‡ä»¶è·¯å¾„ã€‚</td></tr><tr><td><code>output_jsonl_path</code></td><td><code>str</code></td><td><code>None</code></td><td><strong>å¿…é¡»æŒ‡å®š</strong>ã€‚å¤„ç†ç»“æœçš„ä¿å­˜è·¯å¾„ã€‚</td></tr></tbody></table><h2 id="âš¡-run-å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#âš¡-run-å‡½æ•°"><span>âš¡ <code>run</code> å‡½æ•°</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">def</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> DataFlowStorage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    input_image_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">image</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    input_bbox_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">bbox</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">    output_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">mdvp_record</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">):</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œç®—å­ä¸»é€»è¾‘ï¼š</p><ol><li><strong>æ•°æ®è¯»å–</strong> ä» <code>config.input_jsonl_path</code> è¯»å–åŸå§‹æ•°æ®ã€‚</li><li><strong>BBox è·å– (Extract/Get)</strong></li></ol><ul><li>æ£€æŸ¥æ¯è¡Œæ•°æ®æ˜¯å¦åŒ…å« <code>input_bbox_key</code>ã€‚</li><li><strong>Type A (With BBox)</strong>: ç›´æ¥ä½¿ç”¨æ•°æ®ä¸­çš„åæ ‡ã€‚</li><li><strong>Type B (Without BBox)</strong>: è°ƒç”¨ <code>extract_boxes_from_image</code>ï¼Œé€šè¿‡è‡ªé€‚åº”é˜ˆå€¼å’Œå½¢æ€å­¦æ“ä½œæå–ç‰©ä½“è½®å»“ï¼Œå¹¶åº”ç”¨ NMS (éæå¤§å€¼æŠ‘åˆ¶) å»é‡ã€‚</li></ul><ol start="3"><li><strong>æ ‡å‡†åŒ–ä¸å¯è§†åŒ– (Normalize &amp; Visualize)</strong></li></ol><ul><li></li><li><strong>æ ‡å‡†åŒ–</strong>ï¼šå°† <code>[x, y, w, h]</code> è½¬æ¢ä¸ºå½’ä¸€åŒ–çš„ <code>[x1, y1, x2, y2]</code> æ ¼å¼ï¼Œå¹¶æ ¹æ® <code>max_boxes</code> è¿›è¡Œæˆªæ–­æˆ–è¡¥é›¶ (<code>0.0, 0.0, 0.0, 0.0</code>)ã€‚</li><li><strong>å¯è§†åŒ–</strong>ï¼šåœ¨åŸå›¾ä¸Šç»˜åˆ¶ç»¿è‰²çŸ©å½¢æ¡†å’Œæ•°å­—æ ‡ç­¾ï¼Œä¿å­˜è‡³ <code>storage.cache_path</code>ã€‚</li></ul><ol start="4"><li><strong>Prompt ç”Ÿæˆ</strong></li></ol><ul><li>æ ¹æ®æœ‰æ•ˆæ¡†çš„æ•°é‡ï¼Œç”Ÿæˆå›ºå®šæ¨¡æ¿çš„ Promptï¼š</li></ul><blockquote><p>&quot;Describe the content of each marked region in the image. There are {N} regions: &lt;region1&gt; to &lt;regionN&gt;.&quot;</p></blockquote><ol start="5"><li><strong>ç»“æœå¯¼å‡º</strong></li></ol><ul><li>å°†åŒ…å«åŸå§‹ä¿¡æ¯ã€æ ‡å‡†åŒ– BBoxã€å¯è§†åŒ–è·¯å¾„åŠ Prompt çš„å®Œæ•´è®°å½•å†™å…¥ <code>config.output_jsonl_path</code>ã€‚</li></ul><h3 id="ğŸ§¾-run-å‚æ•°è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#ğŸ§¾-run-å‚æ•°è¯´æ˜"><span>ğŸ§¾ <code>run</code> å‚æ•°è¯´æ˜</span></a></h3><table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>storage</code></td><td><code>DataFlowStorage</code></td><td>æ— </td><td>DataFlow å­˜å‚¨å¯¹è±¡ï¼Œä¸»è¦ç”¨äºè·å–ç¼“å­˜è·¯å¾„ (<code>cache_path</code>)ã€‚</td></tr><tr><td><code>input_image_key</code></td><td><code>str</code></td><td><code>&quot;image&quot;</code></td><td>è¾“å…¥ JSONL ä¸­å›¾åƒè·¯å¾„çš„å­—æ®µåã€‚</td></tr><tr><td><code>input_bbox_key</code></td><td><code>str</code></td><td><code>&quot;bbox&quot;</code></td><td>è¾“å…¥ JSONL ä¸­ BBox æ•°æ®çš„å­—æ®µåã€‚</td></tr><tr><td><code>output_key</code></td><td><code>str</code></td><td><code>&quot;mdvp_record&quot;</code></td><td>(ä¿ç•™å­—æ®µ) ç”¨äºæ ‡è¯†è¾“å‡ºè®°å½•çš„é”®åã€‚</td></tr></tbody></table><h2 id="ğŸ§©-ç¤ºä¾‹ç”¨æ³•" tabindex="-1"><a class="header-anchor" href="#ğŸ§©-ç¤ºä¾‹ç”¨æ³•"><span>ğŸ§© ç¤ºä¾‹ç”¨æ³•</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> dataflow</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">utils</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> FileStorage</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">from</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> dataflow</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">operators</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">cv </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ImageBboxGenerator</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ExistingBBoxDataGenConfig</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 1) é…ç½®å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">config </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ExistingBBoxDataGenConfig</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    max_boxes</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">5</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    input_jsonl_path</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">./data/raw_images.jsonl</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    output_jsonl_path</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">./data/processed_with_prompts.jsonl</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 2) åˆå§‹åŒ–ç®—å­</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># æ³¨æ„ï¼šæ­¤ç®—å­ä¸»è¦ç”¨äºæ•°æ®å‡†å¤‡ï¼Œä¸ä¾èµ– Serving å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">generator </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> ImageBboxGenerator</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">config</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">config</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 3) å‡†å¤‡ Storage (ä»…ç”¨äºæä¾›ç¼“å­˜è·¯å¾„)</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> FileStorage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    cache_path</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">./cache_vis_images</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    file_name_prefix</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">bbox_gen</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 4) æ‰§è¡Œå¤„ç†</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># è‡ªåŠ¨è¯»å– config ä¸­çš„ input_jsonl_pathï¼Œç»“æœå†™å…¥ output_jsonl_path</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">generator</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    input_image_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">image_path</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    input_bbox_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ground_truth_bbox</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # è‹¥æ–‡ä»¶ä¸­æ— æ­¤åˆ—ï¼Œå°†è‡ªåŠ¨æå– BBox</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ğŸ§¾-è¾“å‡ºæ•°æ®æ ¼å¼-output-jsonl" tabindex="-1"><a class="header-anchor" href="#ğŸ§¾-è¾“å‡ºæ•°æ®æ ¼å¼-output-jsonl"><span>ğŸ§¾ è¾“å‡ºæ•°æ®æ ¼å¼ (Output JSONL)</span></a></h3><p>ç”Ÿæˆçš„ <code>output_jsonl_path</code> æ–‡ä»¶ä¸­ï¼Œæ¯ä¸€è¡ŒåŒ…å«ä»¥ä¸‹ç»“æ„ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">image</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/data/raw/cat.jpg</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">type</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">without_bbox</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // æˆ– &quot;with_bbox&quot;</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">bbox</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [[</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">100</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 200</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 50</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 60</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">],</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;"> ...</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">],</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // åŸå§‹åƒç´ åæ ‡ [x, y, w, h]</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">normalized_bbox</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> [</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      [</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0.1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0.2</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0.15</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0.26</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">],</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">      [</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">0.0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0.0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0.0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 0.0</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // è¡¥é›¶å¡«å……</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">  ],</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">result_file</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">./cache_vis_images</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">image_with_bbox</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">./cache_vis_images/1_bbox_vis.jpg</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> // å¯è§†åŒ–å›¾ç‰‡è·¯å¾„</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">valid_bboxes_num</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">prompt</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Describe the content of each marked region in the image. There are 1 regions: </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">\\&lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">region1</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">\\&gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">\\&lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">region1</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">\\&gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">.</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,32)]))}const p=i(h,[["render",l]]),d=JSON.parse('{"path":"/zh/mm_operators/generate/image_bbox_generator/","title":"ImageBboxGenerator","lang":"zh-CN","frontmatter":{"title":"ImageBboxGenerator","createTime":"2026/01/11 21:49:37","permalink":"/zh/mm_operators/generate/image_bbox_generator/"},"readingTime":{"minutes":3.07,"words":920},"git":{"createdTime":1768139789000,"updatedTime":1768139789000,"contributors":[{"name":"HankYang","username":"HankYang","email":"hankyang428@gmail.com","commits":1,"avatar":"https://avatars.githubusercontent.com/HankYang?v=4","url":"https://github.com/HankYang"}]},"filePathRelative":"zh/notes/mm_operators/image_understanding/generate/image_bbox_generator.md","headers":[]}');export{p as comp,d as data};
